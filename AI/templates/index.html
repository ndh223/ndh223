<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸš— BÃ£i Äá»— Xe ThÃ´ng Minh</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="floating-vehicles"></div>

    <div class="game-container">
        <div class="header">
            <h1>ğŸš— BÃ£i Äá»— Xe ThÃ´ng Minh ğŸ®</h1>
            <p>Tá»‘i Æ°u hÃ³a bÃ£i Ä‘á»— xe vá»›i AI Hill Climbing!</p>
        </div>

        {% if message %}
            <div class="message {{ 'error' if 'lá»—i' in message.lower() or 'khÃ´ng' in message.lower() or 'tá»“n táº¡i' in message.lower() else 'success' }}">
                {{ message }}
            </div>
        {% endif %}

        <div class="score-board">
            <div class="score-item">
                <div class="score-value">{{ cost }}</div>
                <div class="score-label">Tá»•ng Chi PhÃ­</div>
            </div>
            <div class="score-item">
                <div class="score-value">{{ assigned }}/{{ total }}</div>
                <div class="score-label">Xe ÄÃ£ PhÃ¢n Bá»•</div>
            </div>
            <div class="score-item">
                <div class="score-value">{{ (assigned/total*100) if total > 0 else 0 | round(1) }}%</div>
                <div class="score-label">Hiá»‡u Suáº¥t</div>
            </div>
        </div>

        <div class="game-area">
            <div class="control-panel">
                <h2>ğŸ® ThÃªm/XÃ³a Xe</h2>
                <form method="POST">
                    <input type="hidden" name="action" value="add"/>
                    <div class="form-group">
                        <label for="vehicle_id">ğŸš— Biá»ƒn Sá»‘ Xe:</label>
                        <input type="text" name="vehicle_id" id="vehicle_id" placeholder="Nháº­p biá»ƒn sá»‘ xe..." required>
                    </div>
                    <div class="form-group">
                        <label for="vehicle_size">ğŸ“ KÃ­ch ThÆ°á»›c:</label>
                        <select name="vehicle_size" id="vehicle_size">
                            <option value="small">Xe Nhá» ğŸš—</option>
                            <option value="medium">Xe Vá»«a ğŸš™</option>
                            <option value="large">Xe Lá»›n ğŸš</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="parking_time">â° Thá»i Gian Äá»— (giá»):</label>
                        <input type="number" step="0.5" name="parking_time" id="parking_time" value="1.0" min="0.5" max="24" required>
                    </div>
                    <button type="submit" class="btn">ğŸš€ ThÃªm Xe</button>
                </form>

                <form method="POST" style="margin-top: 15px;">
                    <input type="hidden" name="action" value="remove"/>
                    <div class="form-group">
                        <label for="remove_vehicle_id">ğŸ—‘ï¸ XÃ³a Xe Theo Biá»ƒn Sá»‘:</label>
                        <input type="text" name="remove_vehicle_id" id="remove_vehicle_id" placeholder="Nháº­p biá»ƒn sá»‘ xe Ä‘á»ƒ xÃ³a...">
                    </div>
                    <button type="submit" class="btn" style="background: linear-gradient(45deg,#e74c3c,#c0392b);">ğŸ—‘ï¸ XÃ³a Xe</button>
                </form>

                <form method="POST" style="margin-top: 15px;">
                    <input type="hidden" name="action" value="clear"/>
                    <button type="submit" class="btn" style="background: linear-gradient(45deg,#8e44ad,#6c5ce7);">ğŸ§¹ XÃ³a Táº¥t Cáº£ Xe</button>
                </form>

                {% if vehicles %}
                <div class="vehicle-list">
                    <h3>ğŸš— Danh SÃ¡ch Xe</h3>
                    {% for v in vehicles %}
                        <div class="vehicle-item">
                            <span><strong>{{ v.id }}</strong> - {{ v.size.title() }}</span>
                            <span>{{ v.parking_time }}h</span>
                        </div>
                    {% endfor %}
                </div>
                {% endif %}
            </div>

            <div class="parking-lot">
                <h2>ğŸ¢ BÃ£i Äá»— Xe</h2>
                <div class="parking-spots">
                    {% for s in spots %}
                    <div class="spot {{ 'occupied' if s.occupied else 'empty' }}">
                        <div class="spot-id">Chá»— #{{ s.id }}</div>
                        <div class="spot-info">ğŸ“ {{ s.spot_type.title() }}</div>
                        <div class="spot-info">ğŸ“ {{ s.size.title() }}</div>
                        <div class="spot-info">â­ Äá»™ KhÃ³: {{ s.driver_difficulty }}</div>
                        {% if s.occupied %}
                            <div class="vehicle-assigned">ğŸš— {{ s.occupied }}</div>
                        {% else %}
                            <div class="vehicle-assigned">ğŸ…¿ï¸ Trá»‘ng</div>
                        {% endif %}
                    </div>
                    {% endfor %}
                </div>

                {% if vehicles %}
                <div class="optimization-progress">
                    <h3>ğŸ§  Tá»‘i Æ¯u HÃ³a AI</h3>
                    <p>Thuáº­t ToÃ¡n Hill Climbing Äang Hoáº¡t Äá»™ng</p>
                    <div class="progress-bar">
                        <div class="progress-fill" 
                             data-target-width="{{ (assigned/total*100) if total > 0 else 0 }}" 
                             style="width: 0%"></div>
                    </div>
                    <p>Tá»‘i Æ°u hÃ³a hoÃ n táº¥t! âœ…</p>
                </div>
                {% endif %}
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/script.js') }}"></script>
</body>
</html>